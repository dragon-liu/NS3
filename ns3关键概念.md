## 一.关键概念

#### 1.节点

​	在因特网术语中，主机即终端是指任何一台连接到网络的计算设备。ns-3并非一个专门的因特网模拟器，而是一个网络模拟器。为此不采用术语“主机”，因为这个词太容易让人联想到因特网和及其相关协议。因此，选用其他术语：节点。

​	ns-3中基本计算设备被抽象为节点。你应该将节点设想为一台可以添加各种功能的计算机。为了使一台计算机有效地工作，可以给它添加应用程序、协议栈、外设卡及驱动程序等。ns-3采用了与此相同的模型。

​	节点由C++中的Node类来描述。Node类提供了用于管理仿真器中网络组件表示的各种方法。例如NodeContainer类，用于追踪一组节点指针。通常，ns-3助手一次在多个节点上工作，如果一个设备助手可能在大量的相同节点上安装设备。助手采用的安装方法通常需要NodeContainer作为一个参数。NodeContainers承载多个Ptr<Node>用来指向参考节点。下面两行将会创建ns-3节点对象，它们在仿真中代表计算机。

```c++
NodeContainer nodes;
nodes.Create(2);
```

​	NodeContainer的拓扑生成器提供了一种简便的方式来创建、管理和使用任何节点对象，本文用这些节点来运行模拟器。上面的第一行只是声明了一个名为“nodes”的NodeContainer。第二行调用了nodes对象的Create()方法创建了2个节点。这个容器调用ns-3中的内部函数来产生2个节点对象，并把指向这2个对象的指针存储在系统中。在脚本中它们所代表的节点什么都没有做。构建拓扑的下一步是把节点连接到一个网络中。



#### 2.应用

​	计算机软件通常分为系统软件和应用软件两大类。应用程序需要使用由系统软件控制的资源，而系统软件通常并不直接使用这些资源来完成用户任务。用户往往需要运行应用程序来完成一些特定的任务。系统软件根据计算模型配置和管理计算机中的各种资源，例如内存、处理器周期、硬盘、网络等。

​	通常，系统软件和应用软件的界线表现为特权级的变化，而这种变化是通过操作系统的自陷功能（operating system traps）来实现的。在ns-3中并没有真正的操作系统的概念，更没有特权级别或者系统调用的概念。正如“现实世界”中在计算机上运行应用程序以执行各种任务一样，我们有应用程序的概念，ns-3仿真环境中的应用程序在节点上运行来驱动模拟过程。

​	在ns-3中，需要被仿真的用户程序被抽象为应用。应用在C++中用Application类来描述。这个类提供了管理仿真时用户层应用的各种方法。开发者应当用面向对象的方法自定义和创建新的应用。本文中会使用Application类的实例：UdpEchoClientApplication 和UdpEchoServerApplication。这些应用程序包含了一个client/server应用来发送和回应仿真网络中的数据分组。其中，UdpEchoClientApplication用来回显服务器端所回复的分组。同其他生成器对象类似，UdpEchoServerApplication由 UdpEchoServerHelper 管理。实际上是这个方法的执行才初始化回显服务器的应用，并将应用连接到一个节点上。应用对象需要一个时间参数来“开始”产生数据通信并且可能在一个可选的时间点“停止”。本文提供了开始和停止的2个参数。这些方法以“Time”对象为参数，记录接收时间和发出时间。echo客户端应用的设置与回显服务器端类似。也有一个UdpEchoClientHelper 来管理 UdpEchoClientApplication。UdpEchoServerApplication是回显服务器端所接收到的分组，同时可以记录时间。



#### 3.信道

​	通常把网络中数据流流过的媒介称为信道。当你把以太网线插入到墙壁上的插孔时，你正通过信道将计算机与以太网连接。在ns-3的模拟环境中，你可以把节点连接到代表数据交换信道的对象上。在这里，基本的通信子网这一抽象概念被称为信道，在C++中用channel类来描述。

​	Channel类提供了管理通信子网对象和把节点连接至它们的各种方法。信道类同样可以由开发者以面向对象的方法自定义。一个信道实例可以模拟一条简单的线缆（wire），也可以模拟一个复杂的巨型以太网交换机，甚至可以是无线网络中充满障碍物的三维空间。

​	本文中将使用几个信道模型的实例，包括：CsmaChannel、Point ToPointChannel和WifiChannel。

​	举例来说，CsmaChannel信道模拟了一个可以用于实现载波侦听多路访问通信子网中的媒介，这个信道具有和以太网相似的功能。Point ToPointChannel这个类代表一个简单的点对点信道，此通道上没有多点通信能力，可以有最多2个点至点连接的网络设备。在通道中有2种“线”。第一个连接的设备获取0号线上的传输，第二个设备得到1号线上的传输。每根线有空闲或传输状态。Wi-FiChannel此无线通道实现描述为“又一网络模型”传播模型，在默认情况下，如果没有传播模型需要设置，则是调用者使用通道设置。



#### 4.网络设备

​	以前，如果想把一台计算机连接到网络上，你就必须买一根特定的网络线缆，并在你的计算机上安装称为外设卡的硬件设备。能够实现网络功能的外接卡被称为网络接口卡（网卡）。现在大多数计算机出厂时已经配置了网卡，所以用户看不到这些模块。

​	一张网卡如果缺少控制硬件的软件驱动是不能工作的。在UNIX（或Linux）系统中，外围硬件被称为“设备”。设备通过驱动程序来控制，而网卡通过网卡驱动程序来控制。在UNIX和Linux系统中，网卡被称为像eth0这样的名字。

​	**在ns-3中，网络设备这一抽象概念相当于硬件设备和软件驱动的总和。**ns3仿真环境中，网络设备安装在节点上，使得节点通过信道和其他节点通信。**像真实的计算机一样，一个节点可以通过多个网络设备同时连接到多条信道上。**

​	网络设备由C++中的NetDevice类来描述。NetDevice类提供了管理连接其他节点和信道对象的各种方法，并且允许开发者以面向对象的方法来自定义。本文中将使用几个特定的网络设备作为实例，它们分别是CsmaNetDevice、PointToPointNetDevice 和Wi-FiNetDevice。正如以太网卡被设计成在以太网中工作一样，CsmaNetDevice被设计成在CSMA信道中工作，而Point ToPointNetDevice在PointToPoint信道中工作，Wi-FiNetNevice在Wi-Fi信道中工作。

​	如果需要一个所有被创建的NetDevice对象列表，就需要使用一个NetDeviceContainer 对象来存放它们，就像本文使用一个NodeContainer对象来存放所创建节点。一个NetDeviceContainer被创建了。对于在NodeContainer对象中的每一个节点（对于一个点到点链路必须明确有2个节点），一个PointToPointNetDevice 被创建和保存在设备容器内。一个Point ToPointChannel对象被创建，2个Point ToPointNetDevices与之连接。



#### 5.拓扑帮助

​	在现实的网络中，你会发现主机已装有（或者内置）的网卡。在ns-3中你会发现节点附加了网络设备。在大型仿真网络中，你需要在节点、网络设备和信道之间部署许多连接。

​	既然把网络设备连接到节点、信道、配置IP地址等在ns-3是很普遍的任务，那么干脆提供“拓扑生成器”来使这个工作变得尽可能的容易。举例来说：创建一个网络设备，配置一个MAC地址，把此网络设备装载到节点上，设置节点的协议栈以及连接网络设备到一个信道，这些事情都需要许多分立的ns-3核心操作。而当需要把许多设备连接到多点信道，在网际间将单个网络进行连接时，则需要对ns-3核心进行更多的分立操作。本文提供了拓扑生成器来整合这些大量分立的步骤，使其成为一个简单易用的操作。

​	很明显，Helper类可以极大地方便用户。例如TopologyReaderHelper类可以使得更容易配置和使用通用的TopologyReader。再如类InternetStackHelper是一个安装PointToPointHelper对象和点到点网络设备的网络协议栈的拓扑生成器类，它会为每一个节点容器中的节点安装一个网络协议栈（如TCP、UDP和IP等）。